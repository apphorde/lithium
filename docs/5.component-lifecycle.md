---
title: Component lifecycle
---

# Component lifecycle

Whenever `mount()` API is called on a target, these lifecycle events are executed:

```text
component setup is executed (setup)
     V
DOM structure creation starts (createDom)
     V
check every DOM node (createElement)
     V
check every attribute of a node (applyAttribute)
     V
append structure to document (appendDom)
     V
component starts (init)
     V
a property changes (change)
     V
component is removed from DOM (destroy)
```

## onInit, onUpdate, onDestroy

These hooks can be used inside setup functions or inside reusable code factories.

Example 1: `ready` triggers once, `count` triggers every time a prop changes.

```html
<template>
  <div>
    Ready? {{ready}}<br />
    Update count: {{count}}
  </div>

  <script setup>
    import { onInit, shallowRef, defineProp } from "@li3/web";

    export default function () {
      const trigger = defineProp("trigger");
      const ready = shallowRef(false);
      const count = shallowRef(0);

      onInit(function () {
        ready.value = true;
      });

      onUpdate(function () {
        count.value++;
      });
    }
  </script>
</template>
```

Example 2: reusable code uses hooks:

```ts
// scroll.ts
import { onInit, onDestroy, ref, debounce } from '@li3/web';

export function useWindowScroll() {
  const ref = ref(0);

  const handler = debounce(handler(e) => ref.value = { x: window.scrollX, y: window.scrollY });

  onInit(() => window.addEventListener('scroll', handler));
  onDestroy(() => window.removeEventListener('scroll', handler));

  return ref;
}
```

```html
<!-- index.html -->
<template component="app-scroller">
  <div>Scroll position: {{ scroll.y }}</div>

  <script setup>
    import { useWindowScroll } from "./scroll.js";

    export default function () {
      const scroll = useWindowScroll();
      return { scroll };
    }
  </script>
</template>

<template app>
  <app-scroller></app-scroller>
</template>
```
